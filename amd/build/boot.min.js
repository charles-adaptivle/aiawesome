define("local_aiawesome/boot",["exports","core/str"],(function(_exports,_str){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.generateSessionId=function(){return"sess_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)},_exports.getCurrentCourseId=function(){if(M.cfg.courseId&&1!==M.cfg.courseId)return M.cfg.courseId;const urlMatch=window.location.pathname.match(/\/course\/view\.php.*[?&]id=(\d+)/);if(urlMatch)return parseInt(urlMatch[1],10);const courseId=document.body.getAttribute("data-course-id");if(courseId&&"1"!==courseId)return parseInt(courseId,10);return null},_exports.init=void 0;async function setupUI(){try{await async function(){const title=await(0,_str.getString)("chat_toggle_title","local_aiawesome"),selectors=[".usermenu .dropdown-menu","#user-menu-dropdown",'[data-region="user-menu"] .dropdown-menu','.navbar-nav .dropdown-menu:has([data-title="usermenu"])'];let userMenu=null;for(const selector of selectors)if(userMenu=document.querySelector(selector),userMenu)break;if(!userMenu)return console.warn("AI Awesome: Could not find user menu to inject toggle button"),void function(title){const toggleButton=document.createElement("button");toggleButton.className="aiawesome-floating-toggle",toggleButton.setAttribute("data-aiawesome-toggle","true"),toggleButton.setAttribute("aria-label",title),toggleButton.setAttribute("title",title),toggleButton.innerHTML='<i class="fa fa-comments-o" aria-hidden="true"></i>',Object.assign(toggleButton.style,{position:"fixed",top:"80px",right:"20px",zIndex:"1050",width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#007bff",color:"white",border:"none",boxShadow:"0 2px 10px rgba(0,0,0,0.2)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",transition:"all 0.3s ease"}),toggleButton.addEventListener("mouseenter",(()=>{toggleButton.style.backgroundColor="#0056b3",toggleButton.style.transform="scale(1.1)"})),toggleButton.addEventListener("mouseleave",(()=>{toggleButton.style.backgroundColor="#007bff",toggleButton.style.transform="scale(1)"})),toggleButton.addEventListener("click",handleToggleClick),document.body.appendChild(toggleButton)}(title);const toggleButton=document.createElement("a");toggleButton.className="dropdown-item",toggleButton.href="#",toggleButton.setAttribute("data-aiawesome-toggle","true"),toggleButton.setAttribute("aria-label",title),toggleButton.setAttribute("role","button"),toggleButton.innerHTML=`\n        <i class="icon fa fa-comments-o fa-fw" aria-hidden="true"></i>\n        <span class="menu-action-text">${title}</span>\n    `,toggleButton.addEventListener("click",handleToggleClick);try{const divider=userMenu.querySelector(".dropdown-divider");divider&&divider.parentNode===userMenu?userMenu.insertBefore(toggleButton,divider):userMenu.appendChild(toggleButton)}catch(insertError){userMenu.appendChild(toggleButton)}}(),function(){if(document.getElementById("aiawesome-drawer"))return;const drawer=document.createElement("aside");drawer.id="aiawesome-drawer",drawer.className="aiawesome-drawer",drawer.setAttribute("role","complementary"),drawer.setAttribute("aria-label","AI Chat"),drawer.setAttribute("aria-hidden","true"),drawer.style.display="none",Object.assign(drawer.style,{position:"fixed",top:"0",right:"0",width:"400px",height:"100vh",backgroundColor:"white",boxShadow:"-2px 0 10px rgba(0,0,0,0.1)",zIndex:"1040",transform:"translateX(100%)",transition:"transform 0.3s ease-in-out",display:"flex",flexDirection:"column"}),document.body.appendChild(drawer)}(),document.addEventListener("keydown",(event=>{if("Escape"===event.key){const drawer=document.getElementById("aiawesome-drawer");drawer&&drawer.classList.contains("open")&&closeDrawer()}})),document.addEventListener("click",(event=>{const drawer=document.getElementById("aiawesome-drawer");drawer&&drawer.classList.contains("open")&&(drawer.contains(event.target)||event.target.hasAttribute("data-aiawesome-toggle")||event.target.closest("[data-aiawesome-toggle]")||closeDrawer())})),window.addEventListener("resize",(()=>{const drawer=document.getElementById("aiawesome-drawer");drawer&&(window.innerWidth<768?drawer.style.width="100vw":drawer.style.width="400px")}))}catch(error){console.error("AI Awesome: Failed to initialize UI",error)}}async function handleToggleClick(event){event.preventDefault(),event.stopPropagation();const drawer=document.getElementById("aiawesome-drawer");if(!drawer)return;drawer.classList.contains("open")?closeDrawer():await async function(){const drawer=document.getElementById("aiawesome-drawer");if(!drawer)return;try{drawer.style.display="flex",drawer.classList.add("open"),drawer.setAttribute("aria-hidden","false"),drawer.style.transform="translateX(0)",await async function(){const drawer=document.getElementById("aiawesome-drawer");if(!drawer)return;if(drawer.hasAttribute("data-app-mounted"))return;try{await new Promise(((resolve,reject)=>{require(["local_aiawesome/simple_app"],(app=>{app&&app.mount?app.mount(drawer).then((()=>{drawer.setAttribute("data-app-mounted","true"),resolve()})).catch(reject):reject(new Error("Simple app module does not have mount function"))}),(error=>{reject(error)}))}))}catch(error){!function(drawer){drawer.innerHTML='\n        <div style="padding: 20px; text-align: center; height: 100%; display: flex; flex-direction: column; justify-content: center;">\n            <div style="max-width: 300px; margin: 0 auto;">\n                <h3 style="color: #333; margin-bottom: 15px;">AI Chat Assistant</h3>\n                <div style="color: #666; font-size: 14px; line-height: 1.5;">\n                    <p style="margin-bottom: 10px;">ðŸ¤– The AI chat interface is loading...</p>\n                    <p style="margin-bottom: 15px;">This fallback appears when the main React app fails to load.</p>\n                    <p style="font-size: 12px; color: #999;">\n                        Check the browser console for technical details or try refreshing the page.\n                    </p>\n                </div>\n                <button onclick="this.parentElement.parentElement.parentElement.parentElement.style.display=\'none\'" \n                        style="margin-top: 20px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">\n                    Close\n                </button>\n            </div>\n        </div>\n    '}(drawer),drawer.setAttribute("data-app-mounted","true")}}(),function(drawer){const focusableElements=drawer.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(0===focusableElements.length)return;const firstElement=focusableElements[0],lastElement=focusableElements[focusableElements.length-1];setTimeout((()=>firstElement.focus()),100),drawer.addEventListener("keydown",(event=>{"Tab"===event.key&&(event.shiftKey?document.activeElement===firstElement&&(event.preventDefault(),lastElement.focus()):document.activeElement===lastElement&&(event.preventDefault(),firstElement.focus()))}))}(drawer),updateToggleState(!0)}catch(error){console.error("AI Awesome: Failed to open drawer",error),closeDrawer()}}();const dropdown=event.target.closest(".dropdown");if(dropdown){const menu=dropdown.querySelector(".dropdown-menu");menu&&menu.classList.contains("show")&&menu.classList.remove("show")}}function closeDrawer(){const drawer=document.getElementById("aiawesome-drawer");if(!drawer)return;drawer.classList.remove("open"),drawer.setAttribute("aria-hidden","true"),drawer.style.transform="translateX(100%)",setTimeout((()=>{drawer.classList.contains("open")||(drawer.style.display="none")}),300),updateToggleState(!1);const toggle=document.querySelector("[data-aiawesome-toggle]");toggle&&toggle.focus()}function updateToggleState(isOpen){const toggle=document.querySelector("[data-aiawesome-toggle]");toggle&&(toggle.setAttribute("aria-expanded",isOpen.toString()),isOpen?toggle.classList.add("active"):toggle.classList.remove("active"))}_exports.init=()=>{(M.cfg.developerdebug||document.body.hasAttribute("data-aiawesome-enabled"))&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",setupUI):setupUI())}}));

//# sourceMappingURL=boot.min.js.map